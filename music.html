<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            name="description"
            content="Karl's music taste and listening activity from Last.fm."
        />
        <meta name="author" content="Karl Simmer" />
        <meta name="robots" content="index, follow" />
        <meta property="og:title" content="Music • Karl Simmer" />
        <meta
            property="og:description"
            content="Karl's music taste and listening activity."
        />
        <title>Music • Karl Simmer</title>
        <link rel="icon" type="image/png" sizes="32x32" href="assets/icon.png">
        <link rel="icon" type="image/png" sizes="16x16" href="assets/icon.png">
        <link rel="apple-touch-icon" href="assets/icon.png">
        <link rel="stylesheet" href="style.css" />
        <script async src="https://ackee-production-7e23.up.railway.app/dcph35ptdmw8o3po.js" data-ackee-server="https://ackee-production-7e23.up.railway.app" data-ackee-domain-id="45ef6fd3-9ac0-4c48-9590-992ef2a45612"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
            rel="stylesheet"
        />
        <link
            href="https://api.fontshare.com/v2/css?f[]=satoshi@300,400,500,600,700&display=swap"
            rel="stylesheet"
        />
    </head>
    <body>
        <header>
            <a href="index.html" class="logo-link">
                <div id="logo" class="logo">
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 48.34 67"
                        class="logo-icon"
                    >
                        <defs>
                            <style>
                                .cls-1 {
                                    fill: var(--logo);
                                    stroke-width: 0px;
                                }
                            </style>
                        </defs>
                        <path
                            class="cls-1"
                            d="M24.17,67C15.98,67,0,45.28,0,26.76,0,9.76,8.81,0,24.17,0s24.15,9.75,24.17,26.76c0,18.52-15.98,40.24-24.17,40.24ZM24.17,3C10.52,3,3,11.44,3,26.76c0,17.88,15.87,37.24,21.17,37.24s21.17-18.93,21.17-37.24c-.02-20.68-13.27-23.76-21.17-23.76ZM17.69,41.67h-.01c-2.63,0-5.62-1.6-8-4.27-3.88-4.29-4.92-9.85-2.37-12.65.95-1.06,2.29-1.64,3.78-1.64,2.63,0,5.62,1.6,8,4.27,3.88,4.29,4.92,9.85,2.37,12.65-.95,1.06-2.29,1.64-3.78,1.64ZM11.46,26.11c-.73,0-1.39.28-1.86.8-1.26,1.39-.67,4.97,1.34,8.01,1.88,2.09,4.2,3.36,6.17,3.36.73,0,1.39-.28,1.86-.8,1.26-1.39.67-4.97-1.34-8.01-1.88-2.09-4.2-3.36-6.17-3.36ZM30.64,41.67c-1.49,0-2.83-.58-3.78-1.64-2.55-2.8-1.51-8.36,2.37-12.65,2.38-2.67,5.37-4.27,8-4.27,1.49,0,2.83.58,3.78,1.64,2.55,2.8,1.51,8.36-2.37,12.65-2.38,2.67-5.37,4.27-8,4.27ZM37.23,26.11c-1.97,0-4.29,1.28-6.17,3.36-2.01,3.04-2.6,6.62-1.34,8.01.47.52,1.13.8,1.86.8,1.97,0,4.29-1.28,6.17-3.36,2.01-3.04,2.6-6.62,1.34-8.01-.47-.52-1.13-.8-1.86-.8Z"
                        />
                    </svg>
                </div>
            </a>
            <div class="pin">
              <div class="pin-container" id="pinMenu">
                <div class="pin-toggle">
                  <img src="assets/bars.svg" class="icon" alt="Menu">
                </div>
                <div class="pin-menu-items">
                  <a href="shots.html" class="pin-item">
                    <img src="assets/step-back.svg" class="icon" alt="Previous">
                  </a>
                  <a href="index.html" class="pin-item">
                    <img src="assets/house.svg" class="icon" alt="Home">
                  </a>
                  <a href="shots.html" class="pin-item">
                    <img src="assets/step-forward.svg" class="icon" alt="Next">
                  </a>
                </div>
              </div>
            </div>
        </header>
        <div class="app">
            <section class="study">
                <div class="study-meta">
                    <h1>Music</h1>
                    <div class="study-meta-row">                        
                        <h3>Top artists</h3>
                        <p>My most played artists from the last year, powered by <a href="https://www.last.fm/user/kungfury007" target="_blank" class="text-link">Last.fm</a>.</p>
                    </div>
                </div>
            </section>
            
            <section class="music-section">
                <div id="top-artists" class="artists-container">
                    <div class="loading">Loading top artists...</div>
                </div>
            </section>
        </div>
        
        <script src="js/pin-menu.js"></script>
        <script>
            // Last.fm API configuration
            const LASTFM_API_KEY = '18884ef5782e418d5dacae1bf5794940'; // You'll need to get this
            const LASTFM_USERNAME = 'kungfury007';
            const LASTFM_API_URL = 'https://ws.audioscrobbler.com/2.0/';
            
            // For now, let's use a CORS proxy to avoid CORS issues
            const CORS_PROXY = 'https://api.allorigins.win/raw?url=';
            
            async function fetchTopArtists() {
                try {
                    const url = `${LASTFM_API_URL}?method=user.gettopartists&user=${LASTFM_USERNAME}&api_key=${LASTFM_API_KEY}&format=json&period=12month&limit=10`;
                    const proxyUrl = `${CORS_PROXY}${encodeURIComponent(url)}`;
                    
                    const response = await fetch(proxyUrl);
                    const data = await response.json();
                    
                    displayArtists(data.topartists.artist);
                } catch (error) {
                    console.error('Error fetching artists:', error);
                    document.getElementById('top-artists').innerHTML = '<div class="error">Unable to load top artists at the moment.</div>';
                }
            }
            
            function displayArtists(artists) {
                const container = document.getElementById('top-artists');
                
                if (!artists || artists.length === 0) {
                    container.innerHTML = '<div class="no-artists">No top artists found.</div>';
                    return;
                }
                
                const artistsHTML = artists.map((artist, index) => {
                    const image = artist.image && artist.image[2] ? artist.image[2]['#text'] : '';
                    const playcount = parseInt(artist.playcount).toLocaleString();
                    
                    return `
                        <div class="artist-item">
                            <div class="artist-rank">${index + 1}</div>
                            ${image && image !== '' ? `<img src="${image}" alt="${artist.name}" class="artist-image">` : '<div class="artist-image-placeholder"></div>'}
                            <div class="artist-info">
                                <div class="artist-name">${artist.name}</div>
                                <div class="artist-playcount">${playcount} plays</div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                container.innerHTML = artistsHTML;
            }
            
            // For demo purposes, let's show some placeholder content
            // Remove this when you get your API key
            function showPlaceholderArtists() {
                const container = document.getElementById('top-artists');
                container.innerHTML = `
                    <div class="artist-item">
                        <div class="artist-rank">1</div>
                        <div class="artist-image-placeholder"></div>
                        <div class="artist-info">
                            <div class="artist-name">Get your Last.fm API key</div>
                            <div class="artist-playcount">Visit last.fm/api to get started</div>
                        </div>
                    </div>
                    <div class="api-instructions">
                        <p>To display your actual top artists:</p>
                        <ol>
                            <li>Go to <a href="https://www.last.fm/api" target="_blank">last.fm/api</a></li>
                            <li>Create an API account</li>
                            <li>Get your API key</li>
                            <li>Replace 'YOUR_API_KEY_HERE' in the code</li>
                        </ol>
                    </div>
                `;
            }
            
            // Initialize
            document.addEventListener('DOMContentLoaded', function() {
                if (LASTFM_API_KEY === 'YOUR_API_KEY_HERE') {
                    showPlaceholderArtists();
                } else {
                    fetchTopArtists();
                }
                
                // Initialize pin menu
                const pinMenu = new PinMenu('pinMenu');
                pinMenu.init();
            });
        </script>
        
        <style>
            .music-section {
                max-width: 800px;
                margin: 0 auto;
                padding: 2rem;
            }
            
            .artists-container {
                display: flex;
                flex-direction: column;
                gap: 1rem;
            }
            
            .artist-item {
                display: flex;
                align-items: center;
                gap: 1rem;
                padding: 1rem;
                background: var(--background-secondary);
                border-radius: 8px;
                transition: all 0.2s ease;
            }
            
            .artist-item:hover {
                background: var(--background-tertiary);
            }
            
            .artist-rank {
                font-size: 1.2rem;
                font-weight: 600;
                color: var(--text-secondary);
                min-width: 2rem;
                text-align: center;
            }
            
            .artist-image {
                width: 60px;
                height: 60px;
                border-radius: 50%;
                object-fit: cover;
            }
            
            .artist-image-placeholder {
                width: 60px;
                height: 60px;
                background: var(--background-tertiary);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                position: relative;
            }
            
            .artist-image-placeholder::after {
                content: "♪";
                color: var(--text-secondary);
                font-size: 1.5rem;
            }
            
            .artist-info {
                flex: 1;
            }
            
            .artist-name {
                font-weight: 500;
                margin-bottom: 0.25rem;
            }
            
            .artist-playcount {
                color: var(--text-secondary);
                font-size: 0.9rem;
            }
            
            .loading, .error, .no-artists {
                text-align: center;
                padding: 2rem;
                color: var(--text-secondary);
            }
            
            .api-instructions {
                margin-top: 2rem;
                padding: 1.5rem;
                background: var(--background-secondary);
                border-radius: 8px;
            }
            
            .api-instructions ol {
                margin-top: 1rem;
                padding-left: 1.5rem;
            }
            
            .api-instructions li {
                margin-bottom: 0.5rem;
            }
        </style>
    </body>
</html>
